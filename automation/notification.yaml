# use this files for notifications

# Двери долго открыты
- id: say_close_the_door
  alias: say_close_the_door
  hide_entity: True
  trigger:
    - platform: state
      entity_id: binary_sensor.door_window_sensor_158d0001b145c6
      to: 'on'
      for:
        minutes: 5
    - platform: event
      event_type: timer.finished
      event_data: 
        entity_id: timer.door_alert
  action:
    - service: tts.google_say
      data:
        message: '. Закройте входные двери!'
    - service: persistent_notification.create
      data:
        message: "Входная дверь не закрыта!"
        title: "Инфо"
        notification_id: open_doors
    - service: light.turn_on
      data_template:
        entity_id: 
          - light.rgb_lampa
          - light.rgb_lampa_2
        brightness: 255
        effect: 'Alarm'

# Ворота долго открыты
- id: say_close_the_garage
  alias: say_close_the_garage
  hide_entity: True
  trigger:
    - platform: state
      entity_id: binary_sensor.door_window_sensor_158d0002bf6139
      to: 'on'
      for:
        minutes: 5
    - platform: event
      event_type: timer.finished
      event_data: 
        entity_id: timer.door_alert
  action:
    - service: tts.google_say
      data:
        message: '. Закройте гараж!'
    - service: persistent_notification.create
      data:
        message: "Гараж не закрыт!"
        title: "Инфо"
        notification_id: open_garage
    - service: light.turn_on
      data_template:
        entity_id: 
          - light.rgb_lampa
          - light.rgb_lampa_2
        brightness: 255
        effect: 'Alarm'
#
- id: open_door
  alias: open_door
  hide_entity: True
  trigger:
    - platform: state
      entity_id: binary_sensor.door_window_sensor_158d0001b145c6
      to: 'on'
  action:
    - service: timer.start
      entity_id: timer.door_alert
#
- id: no_internet
  alias: no_internet
  hide_entity: True
  trigger:
    - platform: state
      entity_id: binary_sensor.ping_binary_sensor
      to: 'off'
  action:
    - service: persistent_notification.create
      data:
        message: "Нет выхода в интернет!"
        title: "Интернет"
        notification_id: no_internet
# Двери долго открыты отмена
- id: door_notification_dismiss
  alias: door_notification_dismiss
  hide_entity: True
  trigger:
    - platform: state
      entity_id: binary_sensor.door_window_sensor_158d0001b145c6
      to: 'off'
  action:
    - service: persistent_notification.dismiss
      data:
        notification_id: open_doors
# Ворота долго открыты отмена
- id: garage_notification_dismiss
  alias: garage_notification_dismiss
  hide_entity: True
  trigger:
    - platform: state
      entity_id: binary_sensor.door_window_sensor_158d0002bf6139
      to: 'off'
  action:
    - service: persistent_notification.dissmiss
      data:
        notification_id: open_garage
#